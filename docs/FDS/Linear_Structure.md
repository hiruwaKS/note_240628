# 线性数据结构

## 数组 array / sequential list

* 插入、删除在尾部的时间复杂度为常数，插入最坏为 $O(N)$ 
* `realloc` 一般扩容成两倍；`realloc` 可以理解为 `malloc` + `memcpy` + `free` 
* 一般开一个稍大的数组，保留 `a[0]` 和 `a[size]` ，避免发生段错误
* 删除可以用惰性删除

---

## 链表

* 在真正的头节点再加上一个 *dummy head*，可以避免头部插入、删除的操作成为"特例"
* 链表遍历的优雅写法： `for(; ptr; ptr = ptr->Next)` 
* 删除：注意 `free` 前必须拿一个 `Tmp` 存一下下一个节点
* 反转：最开始 `head <= NULL` ，然后开始将 `head` 前面插入元素

### 链表的合并

* 三个循环： `while(p1 && p2)` 、 `while(p1)` 、 `while(p2)` 
* 当两个链表为单增链表，长度为 $n < m$ ，现在要合成一个单增链表，则最少需要 $n$ 次比较，最多需要 $2n$ 次比较
* 应用：多项式的表示，从两个排序后的链表中找到共有的元素

### 双向链表 doubly linked list

* 首尾 dummy head：空双向链表具有两个 dummy head
* 删除： `p->prior->next=p->next; ` 、 `p->next->prior=p->prior; ` 

### 循环链表 circularly linked list

* 双向循环链表只要一个 dummy head

### Cursor Implementation {: #cursor_implementation}

* 优点：避免了频繁使用 `free` 和 `malloc` 
*  `freelist` ：存放空位

---

## 栈

* 栈：推荐用数组写法

### 中缀表达式（含括号）转后缀表达式

| **token** | **action** |
| -------- | -------- |
| 运算符 | 弹栈到低于自己或者左括号，弹栈 |
| operand | 遇到就弹出 |
| 左括号 | 压栈 |
| 右括号 | 弹栈到左括号 |

* 若是人来判断，关注运算符、左括号的出栈顺序

### 出栈序列与卡特兰数

* **出栈序列和 push / pop 操作的关系**：考虑栈中元素个数，经过 $2n$ 次 push / pop 操作，栈中元素个数不变，且永远不会小于$0$；每一种栈中元素个数变化情况（ $2n$ 项的数列）对应一种出栈序列；**折线图**可以表示这个序列

* **出栈序列的一种判定**：序列是出栈序列$\iff$每个数后面小于自己的所有数全部反转；$e.g.$ $312$ 不是出栈序列。因为 $12$ 比 $3$ 后出栈但是没有被反转。

* **反转**：定义反转$rev()$，$e.g.$ $rev(312) = 213$ 。$T$ 是出栈序列当且仅当 $rev(rev(T)^{-1})$ 是出栈序列，其中 $rev(T)^{-1}$ 是置换群 $S$ 中 $rev(T)$ 的逆元；那么，可以反过来判断 $rev(T)$ 是否能通过一个栈变成 $rev(123...n)$ 来判断 $T$ 是否是出栈序列。另外，出栈序列的逆元素不一定是自己的反转，比如 $3124$，它的逆为 $2314$。

* $C(n)=\frac{1}{n+1} C(2n,n)$
* $C(0,1,2,3,4,...)=1,1,2,5,14,...$

!!! note "see more"
    [神奇的卡特兰数](https://zhuanlan.zhihu.com/p/385994583)

    另外wikipedia上有更加详细的解释

* n对括号匹配
* 字符串出栈问题：`ooops` 有5种出栈（即$C(3)$）；而 `abab` 只有1种出栈（ $3412$ 不是出栈序列）

### 栈的其他应用

* 函数调用：所有递归都可以写成迭代，利用栈
* 平衡符号

---

## 队列

* 用（单向）链表实现队列，最好链表尾做队列头，链表头做队列尾（**首尾交换**），避免"尾删"
* 用数组实现，有两种方案，一种需要用**标志**存当头尾指针重合时是否满，一种需要额外的一个空单元，用**首尾是否相等/是否差一**判断空/满
* 双端队列 deque

## 线段树 树状数组

* 用于计算**前缀和**、**区间和**
*  `lowbit` 函数： `(~A+1)&A`

---

## 其他结构

### 自调整表 self-adjusting list

* 有特定调整功能的链表，工程中常用

### Multilist {: #multilist}

* **两个维度**的遍历
